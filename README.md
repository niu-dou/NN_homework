# 三层神经网络 CIFAR-10 分类器

本项目使用 NumPy 从零开始实现了一个三层全连接神经网络，用于对 CIFAR-10 数据集中的图像进行分类。项目采用模块化设计，包含模型定义、训练、测试和参数可视化等独立组件，完全符合作业要求。实现包括反向传播、SGD 优化、学习率衰减、交叉熵损失、L2 正则化、超参数搜索和多种可视化功能，且不依赖 PyTorch 或 TensorFlow 等深度学习框架。

## 功能特点

- 可自定义隐藏层大小
- 支持反向传播和 SGD 优化
- 包含学习率衰减、交叉熵损失和 L2 正则化
- 超参数搜索和验证集评估
- 可视化训练过程中的损失、验证准确率和模型参数（直方图和热力图）
- 支持模型保存和测试功能

## 依赖

- NumPy

你可以通过以下命令安装 NumPy：
```bash
pip install numpy
```

## 安装步骤

1. 从 [https://www.cs.toronto.edu/~kriz/cifar.html](https://www.cs.toronto.edu/~kriz/cifar.html) 下载 CIFAR-10 数据集，并解压到一个目录。
2. 在 `main()` 函数中，将 `'path/to/cifar-10-batches-py'` 替换为你的数据集实际路径。

## 使用方法

运行 `main()` 函数即可训练和测试模型。该函数会执行以下步骤：
- 加载并预处理 CIFAR-10 数据集
- 将训练数据分割为训练集和验证集
- 执行超参数搜索以找到最佳模型配置
- 使用最佳超参数训练模型
- 可视化训练损失、验证损失和验证准确率
- 保存最佳模型并在测试集上进行评估

运行后，你将看到训练进度的打印输出、最终测试准确率以及生成的可视化图表。

## 可视化内容

项目会生成以下几种图表：
- 训练和验证损失曲线
- 验证准确率曲线
- 模型参数的直方图
- 各层权重的热力图

这些可视化内容有助于理解训练过程和模型参数的特性。

## 结果

模型在测试集上的准确率为 **54.86%**。训练好的模型权重可以从 **(https://pan.baidu.com/s/1Se1-SBbqUNlCvvCAwv4zPQ?pwd=d5qg)** 下载。

## 代码仓库

本项目托管在 GitHub 上：**(https://github.com/niu-dou/NN_homework.git)**
